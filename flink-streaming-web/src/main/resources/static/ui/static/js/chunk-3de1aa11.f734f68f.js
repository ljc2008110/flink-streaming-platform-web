(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3de1aa11"],{1291:function(e,t,n){"use strict";n("851e")},"212d":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[0==e.subPageFlag?n("div",{staticClass:"fl-container"},[n("el-form",{ref:"queryform",attrs:{model:e.queryform,inline:!0}},[n("el-form-item",[n("el-input",{staticClass:"wl-input",attrs:{placeholder:"任务名称(模糊查询)"},on:{input:function(t){return e.handleQuery()}},model:{value:e.queryform.jobName,callback:function(t){e.$set(e.queryform,"jobName",t)},expression:"queryform.jobName"}})],1),n("el-form-item",[n("el-input",{staticClass:"wl-input",attrs:{placeholder:"Flink任务Id"},on:{input:function(t){return e.handleQuery()}},model:{value:e.queryform.jobId,callback:function(t){e.$set(e.queryform,"jobId",t)},expression:"queryform.jobId"}})],1),n("el-form-item",[n("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"任务类型",clearable:""},on:{change:function(t){return e.handleQuery()}},model:{value:e.queryform.jobType,callback:function(t){e.$set(e.queryform,"jobType",t)},expression:"queryform.jobType"}},[n("el-option",{attrs:{label:"全部",value:""}}),n("el-option",{attrs:{label:"SQL流任务",value:"0"}}),n("el-option",{attrs:{label:"SQL批任务",value:"2"}}),n("el-option",{attrs:{label:"JAR包",value:"1"}})],1)],1),n("el-form-item",[n("el-select",{staticStyle:{width:"80px"},attrs:{placeholder:"开启状态",clearable:""},on:{change:function(t){return e.handleQuery()}},model:{value:e.queryform.open,callback:function(t){e.$set(e.queryform,"open",t)},expression:"queryform.open"}},[n("el-option",{attrs:{label:"全部",value:""}}),n("el-option",{attrs:{label:"关闭",value:"0"}}),n("el-option",{attrs:{label:"开启",value:"1"}})],1)],1),n("el-form-item",[n("el-select",{staticStyle:{width:"80px"},attrs:{placeholder:"运行状态",clearable:""},on:{change:function(t){return e.handleQuery()}},model:{value:e.queryform.status,callback:function(t){e.$set(e.queryform,"status",t)},expression:"queryform.status"}},[n("el-option",{attrs:{label:"全部",value:""}}),n("el-option",{attrs:{label:"停止",value:"0"}}),n("el-option",{attrs:{label:"运行中",value:"1"}}),n("el-option",{attrs:{label:"启动中",value:"2"}}),n("el-option",{attrs:{label:"提交成功",value:"3"}}),n("el-option",{attrs:{label:"失败",value:"-1"}}),n("el-option",{attrs:{label:"其他",value:"-2"}})],1)],1),n("el-form-item",[n("el-button",{attrs:{type:"info",icon:"el-icon-delete"},on:{click:function(t){return e.resetForm()}}},[e._v(" 清空 ")])],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.handleQuery()}}},[e._v("搜索")])],1),n("el-form-item",[n("el-dropdown",[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建任务"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("router-link",{staticClass:"wl-append",attrs:{to:{name:e.getRouteTaskName("create","SQL_STREAMING"),params:{flag:"create",context:e.queryContent(),data:{jobTypeEnum:"SQL_STREAMING"}}}}},[n("el-dropdown-item",{attrs:{icon:"iconfont my-icon-jiediansql"}},[e._v("SQL流任务")])],1),n("router-link",{staticClass:"wl-append",attrs:{to:{name:e.getRouteTaskName("create","SQL_BATCH"),params:{flag:"create",context:e.queryContent(),data:{jobTypeEnum:"SQL_BATCH"}}}}},[n("el-dropdown-item",{attrs:{icon:"iconfont my-icon-file-SQL"}},[e._v("SQL批任务")])],1),n("router-link",{staticClass:"wl-append",attrs:{to:{name:e.getRouteTaskName("create","JAR"),params:{flag:"create",context:e.queryContent(),data:{jobTypeEnum:"JAR"}}}}},[n("el-dropdown-item",{attrs:{icon:"iconfont my-icon-suffix-jar"}},[e._v("JAR任务")])],1)],1)],1)],1)],1),n("el-table",{staticClass:"wl-table",attrs:{data:e.list,"header-cell-style":{background:"#f4f4f5","text-align":"center"},"row-style":{height:"20px"},"cell-style":{padding:"3px 0"},border:""}},[n("el-table-column",{attrs:{prop:"id","show-overflow-tooltip":!0,label:"ID","min-width":"50",align:"center",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticStyle:{"margin-right":"5px"}},[e._v(e._s(t.row.id))]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.getTaskTypeName(t.row.jobTypeEnum),placement:"right"}},["SQL_STREAMING"===t.row.jobTypeEnum?n("i",{staticClass:"iconfont my-icon-jiediansql",staticStyle:{"font-size":"16px"}}):e._e(),"SQL_BATCH"===t.row.jobTypeEnum?n("i",{staticClass:"iconfont my-icon-file-SQL",staticStyle:{"font-size":"16px"}}):e._e(),"JAR"===t.row.jobTypeEnum?n("i",{staticClass:"iconfont my-icon-suffix-jar",staticStyle:{"font-size":"16px"}}):e._e()])]}}],null,!1,1905277288)}),n("el-table-column",{attrs:{prop:"jobName","show-overflow-tooltip":!0,label:"任务名称","min-width":"230",align:"center",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.row.jobName,expression:"scope.row.jobName",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onCopyError,expression:"onCopyError",arg:"error"}],staticClass:"el-icon-copy-document"}),e._v(" "+e._s(t.row.jobName)+" ")]}}],null,!1,3511418119)}),n("el-table-column",{attrs:{prop:"isOpen","show-overflow-tooltip":!0,label:"开启",width:"65",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66"},on:{change:function(n){return e.changeIsOpen(n,t.row)}},model:{value:t.row.isOpen,callback:function(n){e.$set(t.row,"isOpen",n)},expression:"scope.row.isOpen"}})]}}],null,!1,1872013021)}),n("el-table-column",{attrs:{prop:"status",label:"状态",width:"70",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[-2===t.row.status||"UNKNOWN"===t.row.status?n("el-tag",{attrs:{type:"info",size:"mini"}},[e._v(e._s(e.getStatusDesc(t.row.status)))]):-1===t.row.status||"FAIL"===t.row.status?n("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v(e._s(e.getStatusDesc(t.row.status)))]):0===t.row.status||"STOP"===t.row.status?n("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v(e._s(e.getStatusDesc(t.row.status)))]):1===t.row.status||"RUN"===t.row.status?n("el-tag",{attrs:{type:"success",size:"mini"}},[e._v(e._s(e.getStatusDesc(t.row.status)))]):2===t.row.status||"STARTING"===t.row.status?n("el-tag",{attrs:{size:"mini"}},[e._v(e._s(e.getStatusDesc(t.row.status)))]):3===t.row.status||"SUCCESS"===t.row.status?n("el-tag",{attrs:{type:"success",size:"mini"}},[e._v(e._s(e.getStatusDesc(t.row.status)))]):n("el-tag",{attrs:{type:"info",size:"mini"}},[e._v(e._s(e.getStatusDesc(t.row.status)))])]}}],null,!1,3710586266)}),n("el-table-column",{attrs:{prop:"deployModeEnum","show-overflow-tooltip":!0,label:"运行模式","min-width":"80",align:"center"}}),n("el-table-column",{attrs:{prop:"jobId","show-overflow-tooltip":!0,label:"Flink任务Id",width:"290",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.jobId?n("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.row.jobId,expression:"scope.row.jobId",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onCopyError,expression:"onCopyError",arg:"error"}],staticClass:"el-icon-copy-document"}):e._e(),t.row.jobId?n("el-link",{attrs:{href:t.row.flinkRunUrl,target:"_blank"}},[e._v(e._s(t.row.jobId))]):e._e()]}}],null,!1,4032232349)}),n("el-table-column",{attrs:{prop:"editTime","show-overflow-tooltip":!0,label:"上次运行","min-width":"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.formatDateTime(t.row.editTime)))])]}}],null,!1,960744588)}),n("el-table-column",{attrs:{prop:"editor","show-overflow-tooltip":!0,label:"提交人","min-width":"50",align:"center"}}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"版本","min-width":"50",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("router-link",{attrs:{to:{name:"HistoryTask",params:{flag:"tasklist",context:e.queryContent(),jobConfigId:t.row.id}}}},[n("el-link",{staticClass:"fl-version-text",attrs:{type:"info"}},[n("span",{staticClass:"fl-version-span"},[e._v(e._s(t.row.version))])])],1)]}}],null,!1,3093736808)}),n("el-table-column",{attrs:{label:"日志",width:"70",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!==t.row.lastRunLogId?n("router-link",{attrs:{to:{name:"ViewTaskLogDetail",params:{flag:"tasklist",context:e.queryContent(),data:{id:t.row.lastRunLogId}}}}},[n("el-link",{attrs:{type:"info",icon:"el-icon-message"}},[e._v("日志")])],1):e._e()]}}],null,!1,1017858086)}),n("el-table-column",{attrs:{label:"SP恢复","show-overflow-tooltip":!0,align:"center",width:"65",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66"},on:{change:function(n){return e.changeAutoRestore(n,t.row)}},model:{value:t.row.autoRestore,callback:function(n){e.$set(t.row,"autoRestore",n)},expression:"scope.row.autoRestore"}})]}}],null,!1,1799321661)}),n("el-table-column",{attrs:{prop:"savepoint",label:"操作",width:"105",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-dropdown",{attrs:{"split-button":"",type:"primary",size:"mini"}},[e._v(" 操作 "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",[1===t.row.isOpen&&"RUN"!==t.row.status?n("el-link",{attrs:{type:"success",icon:"el-icon-video-play"},nativeOn:{click:function(n){return e.startTask(t.row)}}},[e._v("启动")]):e._e()],1),n("el-dropdown-item",[1===t.row.isOpen&&"RUN"===t.row.status?n("el-link",{attrs:{type:"warning",icon:"el-icon-switch-button"},nativeOn:{click:function(n){return e.doStopTask(t.row)}}},[e._v("停止")]):e._e()],1),n("el-dropdown-item",[n("router-link",{attrs:{to:{name:e.getRouteTaskName("view",t.row.jobTypeEnum),params:{flag:"view",context:e.queryContent(),data:t.row},query:{flag:"update",id:t.row.id}}}},[n("el-link",{attrs:{type:"info",icon:"el-icon-view"}},[e._v("详情")])],1)],1),n("el-dropdown-item",[0===t.row.isOpen?n("router-link",{attrs:{to:{name:e.getRouteTaskName("update",t.row.jobTypeEnum),params:{flag:"update",context:e.queryContent(),data:t.row},query:{flag:"update",id:t.row.id}}}},[n("el-link",{attrs:{type:"primary",icon:"el-icon-edit-outline"}},[e._v("修改")])],1):e._e()],1),n("el-dropdown-item",[n("el-link",{attrs:{type:"primary",icon:"el-icon-document-copy"},nativeOn:{click:function(n){return e.copyConfig(t.row)}}},[e._v("复制")])],1),n("el-dropdown-item",[0===t.row.isOpen?n("el-link",{attrs:{type:"danger",icon:"el-icon-delete"},nativeOn:{click:function(n){return e.deleteTask(t.row)}}},[e._v("删除")]):e._e()],1),n("el-dropdown-item",{attrs:{divided:""}},["SQL_STREAMING"===t.row.jobTypeEnum?n("el-link",{attrs:{type:"primary",icon:"el-icon-sell"},nativeOn:{click:function(n){return e.doRecoverSavePoint(t.row)}}},[e._v("恢复")]):e._e()],1),n("el-dropdown-item",["SQL_STREAMING"===t.row.jobTypeEnum?n("el-link",{attrs:{type:"success",icon:"el-icon-sold-out"},nativeOn:{click:function(n){return e.savePoint(t.row)}}},[e._v("备份")]):e._e()],1),n("el-dropdown-item",{attrs:{divided:""}},[null!==t.row.lastRunLogId?n("router-link",{attrs:{to:{name:"ViewTaskLogDetail",params:{flag:"tasklist",context:e.queryContent(),data:{id:t.row.lastRunLogId}}}}},[n("el-link",{attrs:{type:"info",icon:"el-icon-message"}},[e._v("日志")])],1):e._e()],1),n("el-dropdown-item",[n("router-link",{attrs:{to:{name:"FlinkLogManage",params:{flag:"tasklist",context:e.queryContent(),jobConfigId:t.row.id}}}},[n("el-link",{attrs:{type:"info",icon:"el-icon-chat-line-square"}},[e._v("历史")])],1)],1)],1)],1)]}}],null,!1,4097921682)})],1),e.pageshow?n("el-pagination",{staticClass:"wl-pagination",attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":e.currentPage,"page-sizes":[10,15,20,50,100,150,200],"page-size":e.pageSize,total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1):e._e(),n("recover-save-point-dialog",{ref:"recoverSavePointDialog"}),n("stop-task-dialog",{ref:"stopTaskDialog"}),n("router-view")],1)},a=[],r=(n("b0c0"),n("498a"),n("99af"),n("b199")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"wl-dialog",attrs:{title:e.title,visible:e.visible,"close-on-click-modal":!1,"modal-append-to-body":!1,width:"800px"},on:{"update:visible":function(t){e.visible=t},close:function(t){return e.doClose()}}},[n("span",{staticClass:"wl-title"},[e._v("只显示最近10次备份(每一小时自动备份或者停止任务的时候备份)")]),n("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[n("div",{staticClass:"wl-popover"},[n("p",[e._v("备注1：如果sql语句发生变更或者业务逻辑发生变化，此时从savepoint恢复可能导致数据结果错误")]),n("p",[e._v("备注2：yarn模式下和集群模式下统一目录是(必须绑定hdfs)：hdfs:///flink/savepoint/flink-streaming-platform-web/")]),n("p",[e._v("备注3：LOCAL模式本地模式下保存在flink客户端的根目录下")]),n("p",[e._v("备注4：hdfs:///flink/savepoint/flink-streaming-platform-web/ 建议提前创建好")])]),n("span",{attrs:{slot:"reference"},slot:"reference"},[n("i",{staticClass:"el-icon-info"})])]),n("el-form",{ref:"form",staticStyle:{"padding-top":"10px"},attrs:{model:e.form,inline:!0,rules:e.rules}},[n("el-form-item",{attrs:{prop:"savepoint"}},[n("el-input",{ref:"inputSavePoint",staticClass:"wl-input",attrs:{placeholder:"手动增加SavePoint地址"},on:{blur:function(t){return e.blurSavePoint()}},model:{value:e.form.savepoint,callback:function(t){e.$set(e.form,"savepoint",t)},expression:"form.savepoint"}})],1),n("el-form-item",[n("el-button",{on:{click:function(t){return e.addSavepoint()}}},[e._v("手动添加")])],1)],1),n("el-table",{staticClass:"wl-table",attrs:{data:e.list,"header-cell-style":{background:"#f4f4f5","text-align":"center"},"highlight-current-row":"",border:""},on:{"current-change":e.handleCurrentChange}},[n("el-table-column",{attrs:{width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-radio",{attrs:{label:t.$index},nativeOn:{change:function(n){return e.getCurrentRow(t.$index)}},model:{value:e.radioIndex,callback:function(t){e.radioIndex=t},expression:"radioIndex"}})]}}])}),n("el-table-column",{attrs:{prop:"id","show-overflow-tooltip":!0,label:"备份编号",width:"80",align:"center"}}),n("el-table-column",{attrs:{prop:"savepointPath","show-overflow-tooltip":!0,label:"备份地址"}}),n("el-table-column",{attrs:{prop:"backupTime","show-overflow-tooltip":!0,label:"备份时间",width:"135"}})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){return e.doCancel()}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.doConfirm()}}},[e._v("恢复任务")])],1)],1)},i=[],l=(n("c740"),n("295e")),c={name:"RecoverSavePointDialog",data:function(){return{loading:!1,visible:!1,title:"恢复任务运行",form:{taskid:"",savepoint:""},rules:{savepoint:[{required:!0,message:"请输入savepoint地址",trigger:"change"}]},task:{},list:[],currentRow:null,radioIndex:!1}},methods:{openDialog:function(e){this.visible=!0,this.list=[],this.form.savepoint="",this.form.taskid=e.id,this.task=e,this.title="恢复任务运行[".concat(e.jobName,"]"),this.currentRow=null,this.radioIndex=!1,this.querySavePointList(e.id)},querySavePointList:function(e){var t=this;this.loading=!0,this.radioIndex=!1,Object(l["c"])(e).then((function(e){t.loading=!1,t.$refs.form.clearValidate();var n=e.code,o=e.data,a=e.success,r=e.message;"200"===n&&a?(t.list=o&&o.data?o.data:[],t.loading=!1):t.$message({type:"error",message:r||"请求数据异常！"})})).catch((function(e){t.loading=!1,t.$message({type:"error",message:"请求异常！"}),console.log(e)}))},addSavepoint:function(){var e=this;this.$refs.form.validate((function(t){if(t){e.loading=!0;var n=e.form.taskid,o=e.form.savepoint;Object(l["a"])(n,o).then((function(t){e.loading=!1;var o=t.code,a=t.data,r=t.success,s=t.message;"200"===o&&r?(e.list=a&&a.data?a.data:[],e.querySavePointList(n)):e.$message({type:"error",message:s||"请求数据异常！"})})).catch((function(t){e.loading=!1,e.$message({type:"error",message:"请求异常！"}),console.log(t)}))}else e.$refs.inputSavePoint.focus()}))},blurSavePoint:function(){this.$refs.form.clearValidate()},handleCurrentChange:function(e){var t=this;if(e){this.currentRow=e;var n=this.list.findIndex((function(e){return e.id===t.currentRow.id}));n>-1&&(this.radioIndex=n)}},getCurrentRow:function(e){this.radioIndex=e},doConfirm:function(){var e=this;if(this.currentRow){var t=this.form.taskid,n=this.currentRow.id;this.$confirm("是否恢复任务[备份：".concat(n,"]！"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,Object(r["n"])(t,n).then((function(t){e.loading=!1;var o=t.code,a=t.success,r=t.message;"200"===o&&a?(e.$message({type:"info",message:"正在恢复任务[备份：".concat(n,"]，稍后请刷新！")}),e.$parent.getTasks(),e.visible=!1):e.$message({type:"error",message:r||"请求数据异常！"})})).catch((function(t){e.loading=!1,e.$message({type:"error",message:"请求异常！"}),console.log(t)}))}))}else this.$message({type:"error",message:"请选择备份记录！"})},doCancel:function(){this.visible=!1},doClose:function(){this.list=[],this.form.savepoint="",this.form.taskid="",this.task=null,this.title="",this.currentRow=null,this.radioIndex=!1}}},u=c,d=(n("5022"),n("2877")),p=Object(d["a"])(u,s,i,!1,null,"b2e54376",null),f=p.exports,m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"wl-dialog",attrs:{title:e.title,visible:e.visible,"close-on-click-modal":!1,"modal-append-to-body":!1,width:"400px"},on:{"update:visible":function(t){e.visible=t},close:function(t){return e.doClose()}}},[n("span",{staticClass:"wl-title"},[e._v(" 任务ID："+e._s(e.task?e.task.id:"")),n("br"),e._v(" 任务名称："+e._s(e.task?e.task.jobName:"")),n("br"),e._v(" 关闭该任务时是否执行savepoint？ ")]),n("el-form",{ref:"form",staticStyle:{"padding-top":"10px"},attrs:{model:e.form,inline:!0,rules:e.rules}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.stopTaskWsp(!0)}}},[e._v("执行")]),n("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.stopTaskWsp(!1)}}},[e._v("不执行")]),n("el-button",{on:{click:function(t){return e.doCancel()}}},[e._v("取 消")])],1)],1)},g=[],h={name:"StopTaskDialog",data:function(){return{loading:!1,visible:!1,title:"停止任务",form:{},rules:{},task:{}}},methods:{openDialog:function(e){this.visible=!0,this.task=e,this.form.taskid=e.id,this.title="停止任务[".concat(e.jobName,"]")},stopTaskWsp:function(e){var t=this,n=this.form.taskid;this.loading=!0,Object(r["p"])(n,e).then((function(e){t.loading=!1;var n=e.code,o=e.success,a=e.message;"200"===n&&o?(t.$message({type:"success",message:"停止任务[ ".concat(t.task.jobName," ]成功!")}),t.visible=!1,t.doClose(),t.$parent.getTasks()):t.$message({type:"error",message:a||"请求数据异常！"})})).catch((function(e){t.loading=!1,t.$message({type:"error",message:"请求异常！"}),console.log(e),t.visible=!1}))},doCancel:function(){this.visible=!1},doClose:function(){this.list=[],this.form.savepoint="",this.form.taskid="",this.task=null,this.title="",this.currentRow=null,this.radioIndex=!1}}},y=h,w=(n("1291"),Object(d["a"])(y,m,g,!1,null,"286eb510",null)),v=w.exports,b={name:"TaskManage",components:{RecoverSavePointDialog:f,StopTaskDialog:v},data:function(){return{loading:!1,subPageFlag:!1,queryform:{jobId:"",jobName:"",jobType:"0",open:"",status:""},list:[],count:0,pageSize:15,currentPage:1,pageshow:!0}},mounted:function(){if("FlinkTaskManage"===this.$route.name){this.subPageFlag=!1;var e=this.$route.params;e&&e.currentPage&&(this.queryform.jobId=e.jobId,this.queryform.jobName=e.jobName,this.queryform.jobType=e.jobType,this.queryform.open=e.open,this.queryform.status=e.status,e.currentPage&&(this.count=e.count,this.currentPage=e.currentPage,this.pageSize=e.pageSize)),this.handleQuery()}else this.subPageFlag=!0},methods:{doStopTask:function(e){this.$refs.stopTaskDialog.openDialog(e)},onCopySuccess:function(){this.$message({type:"success",message:"已复制到剪贴板"})},onCopyError:function(){this.$message({type:"error",message:"复制失败"})},resetForm:function(){this.queryform.jobId="",this.queryform.jobName="",this.queryform.jobType="0",this.queryform.open="",this.queryform.status="",this.handleQuery()},queryContent:function(){return{count:this.count,currentPage:this.currentPage,pageSize:this.pageSize,jobId:this.queryform.jobId,jobName:this.queryform.jobName,jobType:this.queryform.jobType,open:this.queryform.open,status:this.queryform.status}},handleQuery:function(e){var t=this;this.pageshow=!1,this.getTasks(),this.$nextTick((function(){t.pageshow=!0}))},handleSizeChange:function(e){this.pageSize=e,this.handleQuery()},handleCurrentChange:function(e){this.currentPage=e,this.handleQuery()},getTasks:function(){var e=this;this.loading=!0;var t=this.queryform.jobName.trim(),n=this.queryform,o=n.jobId,a=n.jobType,s=n.status,i=n.open;Object(r["j"])(this.currentPage,this.pageSize,t,o,a,s,i).then((function(t){e.loading=!1;var n=t.code,o=t.success,a=t.message,r=t.data;"200"===n&&o?(e.list=r.data,e.count=r.total,e.count>0&&0===e.list.length&&(e.currentPage=Math.ceil(e.count/e.pageSize),e.getTasks())):e.$message({type:"error",message:a||"请求数据异常！"})})).catch((function(t){e.loading=!1,e.$message({type:"error",message:"请求异常！"}),console.log(t)}))},changeIsOpen:function(e,t){var n=this,o=1===e?"开启":"关闭",a=t.id,s=t.jobName;this.$confirm("是否".concat(o,"[").concat(s,"]"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){1===e?(n.loading=!0,Object(r["k"])(a).then((function(o){n.loading=!1;var a=o.code,r=o.success,i=o.message;if("200"!==a||!r)return t.isOpen=1===e?0:1,void n.$message({type:"error",message:i||"请求数据异常！"});n.$message({type:"success",message:"开启[".concat(s,"]成功！")})})).catch((function(o){n.loading=!1,t.isOpen=1===e?0:1,n.$message({type:"error",message:"请求异常！"}),console.log(o)}))):0===e&&(n.loading=!0,Object(r["c"])(a).then((function(o){n.loading=!1;var a=o.code,r=o.success,i=o.message;if("200"!==a||!r)return t.isOpen=1===e?0:1,void n.$message({type:"error",message:i||"请求数据异常！"});n.$message({type:"success",message:"关闭[".concat(s,"]成功！")})})).catch((function(o){n.loading=!1,t.isOpen=1===e?0:1,n.$message({type:"error",message:"请求异常！"}),console.log(o)})))})).catch((function(n){t.isOpen=1===e?0:1}))},changeAutoRestore:function(e,t){var n=this,o=1===e?"开启":"关闭",a=t.id,s=t.jobName,i=t.autoRestore;this.$confirm("是否".concat(o,"[").concat(s,"]从savepoint恢复启动吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.loading=!0,Object(r["m"])(a,i).then((function(a){n.loading=!1;var r=a.code,i=a.success,l=a.message;if("200"!==r||!i)return t.autoRestore=1===e?0:1,void n.$message({type:"error",message:l||"请求数据异常！"});n.$message({type:"success",message:"".concat(o,"[").concat(s,"]从savepoint恢复启动方式，执行成功！")})})).catch((function(o){n.loading=!1,t.autoRestore=1===e?0:1,n.$message({type:"error",message:"请求异常！"}),console.log(o)}))})).catch((function(n){t.autoRestore=1===e?0:1}))},startTask:function(e){var t=this;this.loading=!0;var n=e.id,o=e.jobName;Object(r["o"])(n).then((function(e){t.loading=!1;var n=e.code,a=e.success,r=e.message;"200"===n&&a?(t.handleQuery(),t.$message({type:"info",message:"正在启动[".concat(o,"]，稍后请刷新！")})):t.$message({type:"error",message:r||"请求数据异常！"})})).catch((function(e){t.loading=!1,t.$message({type:"error",message:"请求异常！"}),console.log(e)}))},stopTask:function(e){var t=this,n=e.id,o=e.jobName;this.$confirm("确定要停止任务【".concat(o,"】吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,Object(r["p"])(n).then((function(e){t.loading=!1;var n=e.code,a=e.success,r=e.message;"200"===n&&a?(t.handleQuery(),t.$message({type:"success",message:"正在停止任务【".concat(o,"】，稍后请刷新！")})):t.$message({type:"error",message:r||"请求数据异常！"})})).catch((function(e){t.loading=!1,t.$message({type:"error",message:"请求异常！"}),console.log(e)}))})).catch((function(e){t.loading=!1,console.log(e)}))},savePoint:function(e){var t=this,n=e.id,o=e.jobName;this.$confirm("确定要手动执行[".concat(o,"]savePoint吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((function(){t.loading=!0,Object(r["l"])(n).then((function(e){t.loading=!1;var n=e.code,a=e.success,r=e.message;"200"===n&&a?t.$message({type:"success",message:"手动执行[".concat(o,"]savePoint成功！")}):t.$message({type:"error",message:r||"请求数据异常！"})})).catch((function(e){t.loading=!1,t.$message({type:"error",message:"请求异常！"}),console.log(e)}))})).catch((function(e){t.loading=!1,console.log(e)}))},copyConfig:function(e){var t=this,n=e.id,o=e.jobName;this.loading=!0,Object(r["d"])(n).then((function(e){t.loading=!1;var n=e.code,a=e.success,r=e.message;"200"===n&&a?(t.handleQuery(),t.$message({type:"success",message:"复制[".concat(o,"]成功！")})):t.$message({type:"error",message:r||"请求数据异常！"})})).catch((function(e){t.loading=!1,t.$message({type:"error",message:"请求异常！"}),console.log(e)}))},deleteTask:function(e){var t=this,n=e.id,o=e.jobName;this.$confirm("确定要删除[".concat(o,"]吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,Object(r["e"])(n).then((function(e){t.loading=!1;var n=e.code,a=e.success,r=e.message;"200"===n&&a?(t.handleQuery(),t.$message({type:"success",message:"删除[".concat(o,"]成功！")})):t.$message({type:"error",message:r||"请求数据异常！"})})).catch((function(e){t.loading=!1,t.$message({type:"error",message:"请求异常！"}),console.log(e)}))})).catch((function(e){t.loading=!1,console.log(e)}))},doRecoverSavePoint:function(e){this.$refs.recoverSavePointDialog.openDialog(e)},formatDateTime:function(e){return this.dayjs(e).format("YYYY-MM-DD HH:mm:ss")},getStatusDesc:function(e){return Object(r["g"])(e)},getTaskTypeName:function(e){switch(e){case"SQL_STREAMING":return"SQL流任务";case"SQL_BATCH":return"SQL批任务";case"JAR":return"JAR包";default:return e}},getRouteTaskName:function(e,t){switch(e){case"create":switch(t){case"SQL_STREAMING":return"CreateSqlStreamingTask";case"SQL_BATCH":return"CreateSqlBatchTask";case"JAR":return"CreateJarTask";default:return""}case"update":switch(t){case"SQL_STREAMING":return"UpdateSqlStreamingTask";case"SQL_BATCH":return"UpdateSqlBatchTask";case"JAR":return"UpdateJarTask";default:return""}case"view":switch(t){case"SQL_STREAMING":return"ViewSqlStreamingTask";case"SQL_BATCH":return"ViewSqlBatchTask";case"JAR":return"ViewJarTask";default:return""}default:return""}}}},k=b,S=(n("bbf5"),Object(d["a"])(k,o,a,!1,null,"4c05c240",null));t["default"]=S.exports},"295e":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return l}));var o=n("b775"),a=n("4328"),r=n.n(a);function s(e){var t=this;return i(e).then((function(e){var n=e.code,o=e.data,a=e.success,r=e.message;return"200"===n&&a?o&&o.data?o.data[0]:{}:(t.$message({type:"error",message:r||"请求数据异常！"}),void console.log(r))})).catch((function(e){t.$message({type:"error",message:"请求异常！"}),console.log(e)}))}function i(e){return Object(o["a"])({url:"/querySavePointList10",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{taskid:e}})}function l(e,t){return Object(o["a"])({url:"/addSavepoint",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{jobConfigId:e,savepointPath:t}})}},"4d79":function(e,t,n){},5022:function(e,t,n){"use strict";n("4d79")},"851e":function(e,t,n){},b199:function(e,t,n){"use strict";n.d(t,"j",(function(){return s})),n.d(t,"h",(function(){return i})),n.d(t,"m",(function(){return l})),n.d(t,"k",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"n",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return h})),n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return w})),n.d(t,"f",(function(){return v})),n.d(t,"i",(function(){return b})),n.d(t,"g",(function(){return k}));var o=n("b775"),a=n("4328"),r=n.n(a);function s(e,t,n,a,s,i,l){return Object(o["a"])({url:"/listTask",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{pageNum:e,pageSize:t,jobName:n,jobId:a,jobType:s,status:i,open:l}})}function i(e){return Object(o["a"])({url:"/getTask",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{id:e}})}function l(e,t){return Object(o["a"])({url:"/setAutoRestore",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{id:e,autoRestore:t}})}function c(e){return Object(o["a"])({url:"/open",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{id:e}})}function u(e){return Object(o["a"])({url:"/close",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{id:e}})}function d(e){return Object(o["a"])({url:"/start",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{id:e}})}function p(e,t){return Object(o["a"])({url:"/stop",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{id:e,isSavePoint:t}})}function f(e,t){return Object(o["a"])({url:"/start",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{id:e,savepointId:t}})}function m(e){return Object(o["a"])({url:"/savepoint",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{id:e}})}function g(e){return Object(o["a"])({url:"/copyConfig",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{id:e}})}function h(e){return Object(o["a"])({url:"/delete",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{id:e}})}function y(e){return Object(o["a"])({url:"/checkfSql",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:{flinkSql:e}})}function w(e){return Object(o["a"])({url:"/addConfig",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:e})}function v(e){return Object(o["a"])({url:"/editConfig",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:e})}function b(e){return Object(o["a"])({url:"/jobConfigHistoryPage",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){return r.a.stringify(e)}],data:e})}function k(e){switch(e){case-2:return"未知";case-1:return"失败";case 0:return"停止";case 1:return"运行中";case 2:return"启动中";case 3:return"提交成功";case 95:return"退出中";case 96:return"退出中";case 97:return"已退出";case 98:return"已完成";case 99:return"重启中";case 100:return"已挂起";case"UNKNOWN":return"未知";case"FAIL":return"失败";case"STOP":return"停止";case"RUN":return"运行中";case"STARTING":return"启动中";case"SUCCESS":return"提交成功";case"CANCELING":return"退出中";case"FAILING":return"退出中";case"CANCELED":return"已退出";case"FINISHED":return"已完成";case"RESTARTING":return"重启中";case"SUSPENDED":return"已挂起";default:return e+"　"}}},bbf5:function(e,t,n){"use strict";n("d412")},d412:function(e,t,n){}}]);